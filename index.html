<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chattanooga Hackers Anonymous (CHA)</title>
  <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico">
  <style>
    body {
      margin: 0;
      height: 100vh;
      background: 
        linear-gradient(to bottom, rgba(0,0,0,0.7), rgba(0,0,0,0.9)), 
        url('aW1hZ2VzCg==/background.png') no-repeat center center fixed;
      background-size: 100% 100%;
      background-repeat: no-repeat;
      background-position: center center;
      background-attachment: fixed;

      font-family: 'Courier New', Courier, monospace;
      color: #33ff33;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }

    .window {
      width: 800px;
      height: 480px;
      background-color: rgba(0, 0, 0, 0.95);
      box-shadow: 0 0 30px #00ff00;
      border: 1px solid #222;
      display: flex;
      flex-direction: column;
    }

    .title-bar {
      height: 30px;
      background-color: #222;
      display: flex;
      align-items: center;
      padding: 0 10px;
      color: #ccc;
      font-size: 0.9rem;
      justify-content: space-between;
    }

    .window-controls {
      display: flex;
      gap: 6px;
    }

    .window-controls div {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: #444;
    }

    .close { background-color: #ff5f56; }
    .minimize { background-color: #ffbd2e; }
    .maximize { background-color: #27c93f; }

    .close:hover { background-color: #ff0000; }
    .minimize:hover { background-color: #e6ac00; }
    .maximize:hover { background-color: #1fbb3f; }

    .terminal {
      flex-grow: 1;
      padding: 20px;
      position: relative;
      overflow-y: auto;
      border-top: 1px solid #333;
    }

    .terminal::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        to bottom,
        rgba(0, 255, 0, 0.05),
        rgba(0, 255, 0, 0.05) 2px,
        transparent 2px,
        transparent 4px
      );
      pointer-events: none;
      z-index: 1;
    }

    .terminal-content {
      position: relative;
      z-index: 2;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .prompt {
      position: absolute;
      bottom: 15px;
      left: 20px;
      font-weight: bold;
      display: flex;
      align-items: center;
      z-index: 2;
      visibility: hidden;
    }

    .cursor {
      width: 10px;
      height: 1em;
      background-color: #33ff33;
      margin-left: 5px;
      animation: blink 1s steps(1) infinite;
    }

    @keyframes blink {
      50% { opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="window">
    <div class="title-bar">
      <div class="window-controls">
        <div class="close"></div>
        <div class="minimize"></div>
        <div class="maximize"></div>
      </div>
      <div>root@cha:~</div>
    </div>
    <div class="terminal">
      <div class="terminal-content" id="terminalContent"></div>
      <div class="prompt" id="promptLine"><span id="promptText">root@cha:~# </span><span class="cursor"></span></div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const terminal = document.getElementById('terminalContent');
      const prompt = document.getElementById('promptLine');
      const promptText = document.getElementById('promptText');

      const bootLines = [
        "CHA // Chattanooga Hackers Anonymous",
        "",
        "Booting up node...",
        "Initializing protocol...",
        "Establishing secure connection...",
        "Access granted.",
        ""
      ];

      const quotes = [
        "Another one got caught today, it's all over the papers.",
        "My crime is that of curiosity.",
        "I am a hacker, and this is my manifesto.",
        "You may stop this individual, but you can't stop us all... after all, we're all alike.",
        "We explore... and you call us criminals.",
        "We seek after knowledge... and you call us criminals.",
        "We exist without skin color, without nationality, without religious bias.",
        "You build atomic bombs, you wage wars, you murder, cheat, and lie to us and try to make us believe it's for our own good.",
        "This is our world now... the world of the electron and the switch, the beauty of the baud.",
        "We make use of a service already existing without paying for what could be dirt-cheap if it wasn't run by profiteering gluttons.",
        "We explore... and you call us criminals. We seek after knowledge... and you call us criminals.",
        "We exist without borders, without limits.",
        "We don't do it for money. We do it because it's who we are.",
        "Yes, I am a criminal. My crime is that of curiosity.",
        "My crime is that of outsmarting you, something that you will never forgive me for.",
        "We tinker, we test, we break, we learn.",
        "This is it... this is where I belong.",
        "You bet your ass we're all alike.",
        "I’ve learned more from a Commodore 64 than from all the teachers at school.",
        "We are the hackers of the world."
      ];

      let commandBuffer = "";
      let lineIndex = 0;
      let charIndex = 0;
      const typingSpeed = 40;
      const lineDelay = 600;

      function escapeHtml(text) {
        return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
      }

      function updatePrompt() {
        promptText.innerHTML = `root@cha:~# ${escapeHtml(commandBuffer)}`;
      }

      function typeQuote(quote, index = 0, doneCallback = () => {}) {
        if (index < quote.length) {
          terminal.innerHTML += escapeHtml(quote.charAt(index));
          setTimeout(() => typeQuote(quote, index + 1, doneCallback), 25);
        } else {
          terminal.innerHTML += "<br/><br/>-- The Mentor, 1986<br/><br/>";
          doneCallback();
        }
      }

      function showRandomQuote() {
        const quote = quotes[Math.floor(Math.random() * quotes.length)];
        terminal.innerHTML = "";
        typeQuote(quote, 0, () => {
          commandBuffer = "";
          updatePrompt();
          prompt.style.visibility = 'visible';
        });
      }

      function enableTyping() {
        document.addEventListener('keydown', function (e) {
          if (e.key === 'Backspace') {
            commandBuffer = commandBuffer.slice(0, -1);
            updatePrompt();
          } else if (e.key === 'Enter') {
            terminal.innerHTML += `<span>root@cha:~# ${escapeHtml(commandBuffer)}</span><br/>`;
            prompt.style.visibility = 'hidden';

            const cmd = commandBuffer.trim().toLowerCase();

            if (cmd === "cat manifesto.txt") {
              setTimeout(showRandomQuote, 400);
            } else if (cmd === "ls") {
              terminal.innerHTML += "meetings/   contact/   manifesto.txt   blog/   code/<br/><br/>";
              commandBuffer = "";
              updatePrompt();
              prompt.style.visibility = 'visible';
            } else if (cmd === "cd meetings" || cmd === "cd meetings.html") {
              window.location.href = "meetings.html";
            } else if (cmd === "cd contact" || cmd === "cd contact.html") {
              window.location.href = "contact.html";
            } else if (cmd === "cd blog" || cmd === "cd blog.html") {
              window.location.href = "blog.html";
            } else if (cmd === "cd code" || cmd === "cd code/") {
              window.location.href = "https://github.com/dc423";
            } else if (cmd.startsWith("sudo ")) {
              terminal.innerHTML += `root@cha:~# ${escapeHtml(commandBuffer)}<br/>`;
              terminal.innerHTML += `You're not in the sudoers file. This incident will be reported.<br/><br/>`;
              
              // Optional dramatic effect:
              terminal.innerHTML += `
              ████████ INTRUSION DETECTED ████████<br/>
              Logging unauthorized privilege escalation attempt...<br/>
              Alert sent to admin@cha<br/><br/>
              `;

              commandBuffer = "";
              updatePrompt();
              prompt.style.visibility = 'visible';
            } else {
              terminal.innerHTML += `bash: command not found: ${escapeHtml(commandBuffer)}<br/><br/>`;
              commandBuffer = "";
              updatePrompt();
              prompt.style.visibility = 'visible';
            }
          } else if (e.key.length === 1) {
            commandBuffer += e.key;
            updatePrompt();
          }
        });
      }

      function buildMotdLines(ip) {
        const ipLine = ip.includes(":")
          ? "OMG IPV6 HACKER"
          : `SERVER IP: ${ip}`;

        const contentLines = [
          "Welcome to NoogaHackers",
          ipLine,
          "",
          "We're currently building something awesome.",
          "Stay tuned..."
        ];

        const boxWidth = Math.max(...contentLines.map(line => line.length));
        const border = "+" + "-".repeat(boxWidth + 4) + "+";

        const padded = contentLines.map(line => {
          const pad = " ".repeat(Math.max(0, boxWidth - line.length));
          return `|  ${line}${pad}  |`;
        });

        return [border, ...padded, border];
      }

      function typeBootLines() {
        if (lineIndex < bootLines.length) {
          const currentLine = bootLines[lineIndex];
          if (charIndex < currentLine.length) {
            terminal.innerHTML += currentLine.charAt(charIndex);
            charIndex++;
            setTimeout(typeBootLines, typingSpeed);
          } else {
            terminal.innerHTML += "<br/>";
            lineIndex++;
            charIndex = 0;
            setTimeout(typeBootLines, lineDelay);
          }
        } else {
          fetch('https://api.ipify.org?format=json')
            .then(res => res.json())
            .then(data => buildMotdLines(data.ip))
            .catch(() => buildMotdLines("UNKNOWN"))
            .then(lines => {
              lines.forEach(line => terminal.innerHTML += line + "<br/>");
              terminal.innerHTML += "<br/>";
              prompt.style.visibility = 'visible';
              enableTyping();
            });
        }
      }

      typeBootLines();
    });
  </script>
</body>
</html>
